<!DOCTYPE html>
<html>
<head>
    
<meta charset="utf-8">

<title>字符串数组和普通数组</title>

<style type="text/css">
    p{
    text-indent: 2em; /*em是相对单位,2em即现在一个字大小的两倍*/
    }
 </style>

</head>
<body>
 
<p>这也是一个老生常谈的问题了，在刷题时遇到了，所以记录一下。</p>

<p><b>sizeof</b>是求表达式所占空间的大小，`strlen`仅仅是单纯的求字符串的长度。下面例子展示了两者使用。</p>

<xmp>
		#include <iostream>
		#include <stdio.h>
		#include <stdlib.h>
		#include <cstring>
		using namespace std;

		void Foo (char str[100])
		{
			cout << "字符数组作为形参退化成指针 sizeof(str) = " << sizeof(str) << endl;
			cout << "字符数组作为形参退化成指针 strlen(str) = " << strlen(str) << endl;
		}

		int main()
		{
			 char a[] = "0123456789";
			 
			 //字符串是常量，所以也是用常量指针指向字符串
			 char const * b = "0123456789";  
			 
			 char *p = a ; 

			 //求字符串长度
			 cout << "strlen a = " << strlen(a) << endl; //求字符串的长度
			 cout << "strlen b = " << strlen(b) << endl; //这也是求字符串的长度

			 cout << "size b = " << sizeof(b) << endl;  //实际是求指针变量大小
			 cout << "size a = " << sizeof(a) << endl;  //实际是求数组空间大小=字符串长度+结束符=11

			 cout << "指向字符数组的指针 size p = " << sizeof(p) << endl;//实际是求指针变量大小

			 char ch[100] = "";
			 Foo(ch);

			 return 0;
		}

		/*
			strlen a = 10
			strlen b = 10
			
			size b = 8
			size a = 11
			
			指向字符数组的指针 size p = 8
			
			字符数组作为形参退化成指针 sizeof(str) = 8
			字符数组作为形参退化成指针 strlen(str) = 0
		 */
</xmp>


<h2>数组和字符数组</h2>

<p>虽然字符数组也是数组，但是和数组还是有区别的。</p>

<p>区别在于字符数组的结尾上，比如<b>char a[] = "012345678"</b>,数据的结尾是'8'吗？当然不是，是'\0'。字符数组还有一种形式就是<b>char d[] = {'1','2','3','4','5','6','7','8','\0'};</b>,它的结尾也是'\0'，前面这两种形式是直接可以输出字符串的。</p>

<p>但是普通数组的最后一个元素值不是'\0'，如果将字符串数组的内容(不包括'\0')拷贝到普通数组中，输出普通数组的内容，<b>后面是会带有一个不确定的字符</b>，代码如下:</p>

<xmp>
    #include <iostream>
    #include <string.h>
    using namespace std;

    char const * ch = "0123456789";  //字符串数组 
    char ch2[11] = "0123456789";     //字符串数组

    int main(){

        cout<<"ch  = "<<ch<<endl;
        cout<<"ch2 = "<<ch2<<endl;

        char ch3[10]; //普通数组

        //第一种 拷贝ch2(不包括'\0')的内容到ch3
        memset(ch3, 0, sizeof(ch3));
        memcpy(ch3,ch2,sizeof(ch3));
        cout<<"ch3 = "<<ch3<<endl;

        //第二种 拷贝ch2所有的内容到ch3
        memset(ch3, 0, sizeof(ch3));
        memcpy(ch3,ch2,sizeof(ch2));
        cout<<"ch3 = "<<ch3<<endl;
    
        return 0;
    }

/*
   输出结果：
            ch  = 0123456789
            ch2 = 0123456789
            ch3 = 0123456789@PU
            ch3 = 0123456789    【TODO 第二种拷贝方式没有出现随机字符很可能时变量空间分布问题，以后可以排查一下】
*/

</xmp>
 
</body>
</html>


